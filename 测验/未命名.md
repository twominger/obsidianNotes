


# 部署openstack
# 部署单节点ceph(两台)
## 部署流程
- vmware虚拟机准备，两台，NAT，除系统盘外再加9块硬盘
- 安装必要组件
```shell
yum -y install python3
yum -y install lvm2
yum -y install podman
```
- 配置时间同步
```shell
cat >/etc/chrony.conf <<EOF
pool ntp.aliyun.com iburst
driftfile /var/lib/chrony/drift
makestep 1.0 3
rtcsync
allow 172.16.1.0/24
keyfile /etc/chrony.keys
leapsectz right/UTC
logdir /var/log/chrony
EOF

systemctl restart chronyd
systemctl enable chronyd
chronyc sources
```
- 下载cephadm脚本并安装
```shell
# 下载
wget http://lab4.cn/cephadm
# 添加存储库
./cephadm add-repo --release pacific
# 安装cephadm
./cephadm install
```
- 引导ceph集群
```shell
# 注意--mon-ip修改为本机IP
./cephadm bootstrap --mon-ip 172.18.0.20 --allow-fqdn-hostname --skip-monitoring-stack --skip-dashboard
```
>[!tip]
>`--allow-fqdn-hostname` 允许使用主机名进行节点识别
>`--skip-monitoring-stack` 跳过 Ceph 集群的监控栈部署
>`--skip-dashboard` 跳过 **Ceph Dashboard** 部署

- 安装ceph的客户端软件
```shell
yum -y install ceph-common
```
- 添加osd
```shell
ceph orch apply osd --all-available-devices
```
- 修改故障域为OSD
```shell

```
# cinder对接ceph
## ceph节点
```shell

```
# 本地yum源，harbor镜像仓库
# k8s集群搭建
# mysql部署
# mysql对接ceph
# discuz容器发布
# prometheus


