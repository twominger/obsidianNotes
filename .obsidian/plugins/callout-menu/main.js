/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var E=Object.defineProperty;var V=Object.getOwnPropertyDescriptor;var F=Object.getOwnPropertyNames;var z=Object.prototype.hasOwnProperty;var H=(d,o,e)=>o in d?E(d,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):d[o]=e;var R=(d,o)=>{for(var e in o)E(d,e,{get:o[e],enumerable:!0})},q=(d,o,e,a)=>{if(o&&typeof o=="object"||typeof o=="function")for(let s of F(o))!z.call(d,s)&&s!==e&&E(d,s,{get:()=>o[s],enumerable:!(a=V(o,s))||a.enumerable});return d};var j=d=>q(E({},"__esModule",{value:!0}),d);var T=(d,o,e)=>(H(d,typeof o!="symbol"?o+"":o,e),e);var $={};R($,{default:()=>b});module.exports=j($);var p=require("obsidian");var B={edit:{en:"Edit",ru:"\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C"},collapsed:{en:"Collapsed by default",ru:"\u0421\u0432\u0451\u0440\u043D\u0443\u0442\u044B\u0439 \u043F\u043E \u0443\u043C\u043E\u043B\u0447\u0430\u043D\u0438\u044E"},expanded:{en:"Expanded by default",ru:"\u0420\u0430\u0437\u0432\u0451\u0440\u043D\u0443\u0442\u044B\u0439 \u043F\u043E \u0443\u043C\u043E\u043B\u0447\u0430\u043D\u0438\u044E"},removeCollapsing:{en:"Remove collapsing",ru:"\u0423\u0431\u0440\u0430\u0442\u044C \u0441\u0432\u043E\u0440\u0430\u0447\u0438\u0432\u0430\u043D\u0438\u0435"},calloutType:{en:"Callout type",ru:"\u0422\u0438\u043F \u0432\u044B\u043D\u043E\u0441\u043D\u043E\u0433\u043E \u0431\u043B\u043E\u043A\u0430"},other:{en:"Other...",ru:"\u0414\u0440\u0443\u0433\u0438\u0435..."},calloutTypePlaceholder:{en:"Callout type...",ru:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0438\u043F \u0432\u044B\u043D\u043E\u0441\u043D\u043E\u0433\u043E \u0431\u043B\u043E\u043A\u0430..."},addMetadata:{en:"Add callout metadata",ru:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043C\u0435\u0442\u0430\u0434\u0430\u043D\u043D\u044B\u0435"},removeMetadata:{en:"Remove callout metadata",ru:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u043C\u0435\u0442\u0430\u0434\u0430\u043D\u043D\u044B\u0435"},clearFormatting:{en:"Clear formatting",ru:"\u041E\u0447\u0438\u0441\u0442\u0438\u0442\u044C \u0444\u043E\u0440\u043C\u0430\u0442\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u0435"},calloutTypes:{en:"Callout types",ru:"\u0422\u0438\u043F\u044B \u0432\u044B\u043D\u043E\u0441\u043D\u044B\u0445 \u0431\u043B\u043E\u043A\u043E\u0432"},calloutTypesDesc:{en:"Write a list of callout types (separated by commas) that should appear in context menu.",ru:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u043F\u0438\u0441\u043E\u043A \u0442\u0438\u043F\u043E\u0432 \u0432\u044B\u043D\u043E\u0441\u043D\u044B\u0445 \u0431\u043B\u043E\u043A\u043E\u0432, \u043A\u043E\u0442\u043E\u0440\u044B\u0435 \u0431\u0443\u0434\u0443\u0442 \u043E\u0442\u043E\u0431\u0440\u0430\u0436\u0430\u0442\u044C\u0441\u044F \u0432 \u043A\u043E\u043D\u0442\u0435\u043A\u0441\u0442\u043D\u043E\u043C \u043C\u0435\u043D\u044E (\u0447\u0435\u0440\u0435\u0437 \u0437\u0430\u043F\u044F\u0442\u0443\u044E)."},metadataTypes:{en:"Callout metadata types",ru:"\u0422\u0438\u043F\u044B \u043C\u0435\u0442\u0430\u0434\u0430\u043D\u043D\u044B\u0445 \u0434\u043B\u044F \u0432\u044B\u043D\u043E\u0441\u043D\u044B\u0445 \u0431\u043B\u043E\u043A\u043E\u0432"},metadataTypesDesc:{en:"Write a list of callout metadata types (separated by commas) that should appear in context menu.",ru:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u043F\u0438\u0441\u043E\u043A \u0442\u0438\u043F\u043E\u0432 \u043C\u0435\u0442\u0430\u0434\u0430\u043D\u043D\u044B\u0445 \u0434\u043B\u044F \u0432\u044B\u043D\u043E\u0441\u043D\u044B\u0445 \u0431\u043B\u043E\u043A\u043E\u0432, \u043A\u043E\u0442\u043E\u0440\u044B\u0435 \u0431\u0443\u0434\u0443\u0442 \u043E\u0442\u043E\u0431\u0440\u0430\u0436\u0430\u0442\u044C\u0441\u044F \u0432 \u043A\u043E\u043D\u0442\u0435\u043A\u0441\u0442\u043D\u043E\u043C \u043C\u0435\u043D\u044E (\u0447\u0435\u0440\u0435\u0437 \u0437\u0430\u043F\u044F\u0442\u0443\u044E)."},copyContent:{en:"Copy callout content",ru:"\u0421\u043A\u043E\u043F\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0441\u043E\u0434\u0435\u0440\u0436\u0438\u043C\u043E\u0435"},copyLinkText:{en:"Copy link text",ru:"\u041A\u043E\u043F\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0442\u0435\u043A\u0441\u0442 \u0441\u0441\u044B\u043B\u043A\u0438"},copyLinkURL:{en:"Copy link URL",ru:"\u041A\u043E\u043F\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0430\u0434\u0440\u0435\u0441 \u0441\u0441\u044B\u043B\u043A\u0438"},copyLinkPath:{en:"Copy link path",ru:"\u041A\u043E\u043F\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0430\u0434\u0440\u0435\u0441 \u0441\u0441\u044B\u043B\u043A\u0438"},openInDefaultBrowser:{en:"Open link in default browser",ru:"\u041E\u0442\u043A\u0440\u044B\u0442\u044C \u0441\u0441\u044B\u043B\u043A\u0443 \u0432 \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0435 \u043F\u043E \u0443\u043C\u043E\u043B\u0447\u0430\u043D\u0438\u044E"}},O={types:"note, info, tip",metaTypes:"no-icon, no-title"},b=class extends p.Plugin{constructor(){super(...arguments);T(this,"settings")}async onload(){if(await this.loadSettings(),this.addSettingTab(new P(this.app,this)),p.Platform.isDesktop&&this.registerDomEvent(window,"contextmenu",e=>{e.button==2&&e.target.closest(".cm-callout")&&this.createCalloutMenu(e)}),p.Platform.isMobile){let e;this.registerDomEvent(window,"touchstart",a=>{a.target.closest(".cm-callout")&&(e=setTimeout(()=>{e=null,this.createCalloutMenu(a)},500))}),this.registerDomEvent(window,"touchend",a=>{clearTimeout(e)})}}onunload(){}async loadSettings(){this.settings=Object.assign({},O,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}getPath(e){let a=u=>{let r=C=>{let S=C.parentElement||C.parentNode,w=-1,c;for(;S&&(c=S.childNodes[++w]);)if(c==C)return w;return-1},f,L=[],I=r(u);return(f=u.parentElement||u.parentNode)&&(L=a(f)),I>-1&&L.push(u),L},s=e.path;return s||(s=e.composedPath()),(!s||s.length==0)&&(s=a(e.target)),s}createCalloutMenu(e){let a=e.target,s=a.closest(".cm-callout"),u=a.closest(".callout"),r=a.closest("a"),f=this.settings.types.split(",").map(t=>t.trim()),L=this.settings.metaTypes.split(",").map(t=>t.trim()),I=["note","info","important","tip","success","question","warning","example","quote","abstract","summary","tldr","todo","hint","check","done","question","faq","help","caution","attention","failure","fail","missing","danger","error","bug","example","cite"],C=u.classList,S=u.getAttribute("data-callout-fold"),w=s.cmView.widget,c=w.editor.editor,m=c.offsetToPos(w.start).line,A=c.offsetToPos(w.end).line,h=c.getLine(m),k=[];for(let t=m;t<=A;t++)k.push(t);let v=h.replace(/(.*?])(.*)/,"$1"),D=s.cmView.widget.getType().replace(/([^|]+)(.*)/,"$1"),U=[...L],x=L.filter(t=>v.includes("|"+t+"|")||v.includes("|"+t+"]")),M=U.filter(t=>!v.includes("|"+t+"|")&&!v.includes("|"+t+"]")),l=new p.Menu;if(l.addItem(t=>t.setTitle(this.getLocalStrings().edit).onClick(()=>{a.click()})),l.addItem(t=>t.setTitle(this.getLocalStrings().copyContent).onClick(()=>{k.shift();let n="";for(let i of k){let y=c.getLine(i).replace(">","");y=y.replace(/^ /,""),n+=y+`
`}n=n.trim(),navigator.clipboard.writeText(n)})),l.addSeparator(),r&&r.className&&(l.addItem(t=>t.setTitle(this.getLocalStrings().copyLinkText).onClick(()=>{navigator.clipboard.writeText(r.innerText)})),r.className.includes("external-link")&&(l.addItem(t=>t.setTitle(this.getLocalStrings().copyLinkURL).onClick(()=>{navigator.clipboard.writeText(r.href)})),l.addItem(t=>t.setTitle(this.getLocalStrings().openInDefaultBrowser).onClick(()=>{let n=this.app.internalPlugins.getEnabledPluginById("webviewer");n?n.openUrlExternally(r.href):window.open(r.href)}))),r.className.includes("internal-link")&&l.addItem(t=>t.setTitle(this.getLocalStrings().copyLinkPath).onClick(()=>{let n=r.getAttribute("data-href")||"";navigator.clipboard.writeText(n)})),l.addSeparator()),C.contains("is-collapsible")&&S=="-"?(l.addItem(t=>{t.setTitle(this.getLocalStrings().expanded).setIcon("plus").onClick(()=>{c.setLine(m,h.replace("]-","]+"))})}),l.addItem(t=>{t.setTitle(this.getLocalStrings().removeCollapsing).setIcon("x").onClick(()=>{c.setLine(m,h.replace("]-","]"))})})):C.contains("is-collapsible")&&S=="+"?(l.addItem(t=>{t.setTitle(this.getLocalStrings().collapsed).setIcon("minus").onClick(()=>{c.setLine(m,h.replace("]+","]-"))})}),l.addItem(t=>{t.setTitle(this.getLocalStrings().removeCollapsing).setIcon("x").onClick(()=>{c.setLine(m,h.replace("]+","]"))})})):(l.addItem(t=>{t.setTitle(this.getLocalStrings().collapsed).setIcon("minus").onClick(()=>{c.setLine(m,h.replace("]","]-"))})}),l.addItem(t=>{t.setTitle(this.getLocalStrings().expanded).setIcon("plus").onClick(()=>{c.setLine(m,h.replace("]","]+"))})})),l.addSeparator(),p.Platform.isMobile){for(let t of f)l.addItem(n=>{let i=t[0].toUpperCase()+t.slice(1,t.length).replace("|"," | ");n.setTitle(i).onClick(()=>{s.cmView.widget.updateType(t)}).setChecked(D==t)});if(l.addItem(t=>{let n=this.getLocalStrings().other;t.setTitle(n).onClick(async()=>{let i=await this.calloutSuggester(I);s.cmView.widget.updateType(i)})}),l.addSeparator(),M.length>0)for(let t of M)l.addItem(n=>{let i=t[0].toUpperCase()+t.slice(1,t.length).replace("|"," | ");n.setTitle(i).setIcon("plus").onClick(()=>{c.setLine(m,h.replace("]","|"+t+"]"))})});if(l.addSeparator(),x.length>0)for(let t of x)l.addItem(n=>{let i=t[0].toUpperCase()+t.slice(1,t.length).replace("|"," | ");n.setTitle(i).setIcon("minus").onClick(()=>{c.setLine(m,h.replace("|"+t,""))})})}else l.addItem(t=>{t.setTitle(this.getLocalStrings().calloutType);let n=t.setSubmenu();n.dom.classList.add("callout-menu");for(let i of f)n.addItem(g=>{let y=i[0].toUpperCase()+i.slice(1,i.length).replace("|"," | ");g.setTitle(y).onClick(()=>{s.cmView.widget.updateType(i)}).setChecked(D==i)});n.addItem(i=>{let g=this.getLocalStrings().other;i.setTitle(g).onClick(async()=>{let y=await this.calloutSuggester(I);s.cmView.widget.updateType(y)})})}),M.length>0&&l.addItem(t=>{t.setTitle(this.getLocalStrings().addMetadata);let n=t.setSubmenu();n.dom.classList.add("callout-menu");for(let i of M)n.addItem(g=>{let y=i[0].toUpperCase()+i.slice(1,i.length).replace("|"," | ");g.setTitle(y).onClick(()=>{c.setLine(m,h.replace("]","|"+i+"]"))})})}),x.length>0&&l.addItem(t=>{t.setTitle(this.getLocalStrings().removeMetadata);let n=t.setSubmenu();n.dom.classList.add("callout-menu");for(let i of x)n.addItem(g=>{let y=i[0].toUpperCase()+i.slice(1,i.length).replace("|"," | ");g.setTitle(y).onClick(()=>{c.setLine(m,h.replace("|"+i,""))})})});l.addSeparator(),l.addItem(t=>t.setTitle(this.getLocalStrings().clearFormatting).setIcon("eraser").onClick(()=>{for(let n of k){let g=c.getLine(n).replace(">","");n==m&&(g=g.replace("]+","]").replace("]-","]").replace(/(\[.*?\])(.*)/,"$2").replace(/^ /,"")),g=g.replace(/^ /,""),c.setLine(n,g)}})),l.showAtMouseEvent(e),l.dom.classList.add("callout-menu")}async calloutSuggester(e){let a=this.getLocalStrings().calloutTypePlaceholder;return new Promise((u,r)=>{new N(this.app,u,r,e,a).open()})}getLocalStrings(){var s,u;let e=(s=window.localStorage.getItem("language"))!=null?s:"en",a={...B};for(let r in a){let f=a[r];a[r]=(u=f[e])!=null?u:f.en}return a}},N=class extends p.FuzzySuggestModal{constructor(e,a,s,u,r){super(e);T(this,"resolve");T(this,"reject");T(this,"values");T(this,"placeholder");this.resolve=a,this.reject=s,this.values=u,this.placeholder=r}getItems(){return this.values}getItemText(e){return this.setPlaceholder(this.placeholder),e}renderSuggestion(e,a){let s=e.item;a.createEl("div",{text:s})}onChooseItem(e){this.resolve(e)}},P=class extends p.PluginSettingTab{constructor(e,a){super(e,a);T(this,"plugin");this.plugin=a}display(){let{containerEl:e}=this;e.empty(),new p.Setting(e).setName(this.plugin.getLocalStrings().calloutTypes).setDesc(this.plugin.getLocalStrings().calloutTypesDesc).addTextArea(a=>a.setValue(this.plugin.settings.types).onChange(async s=>{this.plugin.settings.types=s,await this.plugin.saveSettings()})),new p.Setting(e).setName(this.plugin.getLocalStrings().metadataTypes).setDesc(this.plugin.getLocalStrings().metadataTypesDesc).addTextArea(a=>a.setValue(this.plugin.settings.metaTypes).onChange(async s=>{this.plugin.settings.metaTypes=s,await this.plugin.saveSettings()}))}};

/* nosourcemap */